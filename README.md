# Проект Clash Royale Bot

## Вводная
Clash Royale — это соревновательная мобильная игра от Supercell, где игроки сражаются 1 на 1, используя колоды из 8 карт, каждая из которых призывает войска, заклинания или здания.

Жанр: гибрид tower defense + коллекционная карточная игра.

Визуал: яркий, простой дизайн, четкие анимации.

Основная механика:
1. Боевая колода составляется из 8 карт, из всего доступных >120 карт.
2. У каждой карты есть своя механика.
3. У каждой карты есть стоимость в эликсире.
4. У каждого игрока есть свой запас эликсира.
5. Эликсир накапливается постепенно, максимум 10.
6. Игрок не видит цикл карт противника, а также его запас эликсира.

Поле боя:
1. Две арены, разделенные рекой посередине.
2. У каждого игрока своя половина арены.
3. Каждая арена состоит из 2 боковых башен и 1 центральной (королевской).

Цель:
1. Снести больше башен за 3 минуты.
2. Уничтожение королевской башни = мгновенная победа.

Геймплей:
1. Карту можно разыграть только если для этого хватает запаса эликсира
2. В руке всегда доступно 4 карты из 8, оставшиеся находятся в очереди.
3. Игрок размещает карты на поле, которые превращаются в юнитов, здания или заклинания.
4. Войска двигаются автоматически к башням противника.
5. Бой идет в реальном времени, без пауз.
6. Скорость накапливания эликсира ускоряется, ближе к концу игры.
7. У всех карт уникальные механики взаимодействия друг с другом, с ареной и элексиром.


## Цель проекта
Создать программу с использованием компьютерного зрения (YOLO11) для анализа игры Clash Roale, и вывода полезной информации на экран (цикл карт, актуальное количество эликсира у противника).
Используем ОС Windows 11 only. В дальнейшем миграция на Android систему.


## Общий план
- I. Обучение модели (бета-версия, модель на 20 классов)
- II. Написание кода (проверка потенциала проекта, простая реализация)
- III. Масштабирование (обучение модели на все 200 классов, улучшение масштабирование кода)
- IV. Миграция (на Kotlin в Android)
- V. Распространение (app -> Google Play, info -> YouTube)


### I. Обучение модели
1. создать пару записей боёв
2. определить список карт для бета версии (20 карт)
3. создать ~200 скриншотов, по 10+ скринов/карта
4. сделать разметку в Roboflow
5. проеврить полученную модель по метрикам
6. проверить модель по записанным видео (на глазок)

✓ все удачно, модель получилось обучить, результаты очень хорошие


### II. Написание кода
1. захват заданной области
2. передача картинок (3-4 кадра/сек)
3. обработка моделью
4. алгоритм анализа (определить цикл, эликсир)
5. вывод информации в терминал
6. вывод информации визуально
7. проверка скорость и точности

-> сейчас тут


### III. Масштабирование
1. увеличиваем выборку в 10 раз, размечаем все оставшиеся классы
2. обучаем модель m размера (YOLOv11-m), structured pruning, дообучаем, квантуем INT8.
3. все вычислительния на облачных ресурсах
4. оптемизация кода ("условия игнорирования","сложные ситуации","спорные ситуации")
5. тестирование


### IV. Миграция


### V. Распространение


---

## Работа программы

Требования

- Python 3.8 или выше
- Windows 10/11
- Обученная модель YOLO11 в папке `models/`


Запуск

```bash
python app.py
```

При первом запуске программа попросит выбрать область экрана:
1. Откроется окно со скриншотом всего экрана
2. Выделите область с игрой Clash Royale мышью
3. Нажмите **Enter** для подтверждения или **ESC** для отмены
4. Координаты сохранятся в файл `roi_config.txt`

При следующих запусках программа автоматически загрузит сохраненные координаты.





## Структура проекта

```
project_13_ClashBot/
├── data/                       # Картинки
├── requirements.txt            # Зависимости Python
├── config.py                   # Конфигурация и настройки
├── roi_config.txt              # Сохраненные координаты области
├── app.py                      # Главный файл запуска
├── modules/
│   ├── __init__.py
│   ├── all_card.py             # Классы всех карт
│   ├── card_maneger.py         # Управление циклом карт
│   ├── game_state.py           # Менеджер состояния игры
│   ├── timer_processor.py      # Обработка красных таймеров
│   ├── spell_processor.py      # Обработка заклинаний
│   ├── ability_processor.py    # Обработка абилок чемпионов
│   ├── evolution_processor.py  # Обработка маркеров эволюций
│   ├── screen_capture.py       # Захват экрана
│   ├── detector.py             # Детекция объектов
|   ├── overlay_dynamic.py      # Динамический overlay элементов
│   └── overlay_static.py       # Статичный overlay элементов
├── tests/
├── models/                     # Модели YOLO
└── README.md                   # Документация
```


---


## Авторские права

© 2025 van4956. Все права защищены.
Код данного проекта является частной интеллектуальной собственностью автора.
Использование, копирование и распространение запрещено без письменного разрешения.