# Проект Clash Royale Bot

## Вводная
Clash Royale — это соревновательная мобильная игра от Supercell, где игроки сражаются 1 на 1, используя колоды из 8 карт, каждая из которых призывает войска, заклинания или здания.

Жанр: гибрид tower defense + коллекционная карточная игра.
Визуал: мультяшный, яркий, простой дизайн, четкие анимации, юмор.
Атмосфера: арена/стадион, где бой подается как спортивное соревнование.

Основная механика:
1. Боевая колода составляется из 8 карт, из всего доступных >120 карт.
2. У каждой карты есть своя механика.
3. У каждой карты есть стоимость в эликсире.
4. У каждого игрока есть свой запас эликсира.
5. Эликсир накапливается постепенно, максимум 10.
6. Игрок не видит цикл карт противника, а также его запас эликсира.

Поле боя
1. Две арены, разделенные рекой посередине.
2. У каждого игрока своя половина арены.
3. Каждая арена состоит из 2 боковых башен и 1 центральной (королевской).

Цель
1. Снести больше башен за 3 минуты.
2. Уничтожение королевской башни = мгновенная победа.

Геймплей
1. Карту можно разыграть только если для этого хватает запаса эликсира
2. Доступно всегда только 4 карты из 8, карты в руке чередуются по принципу стека.
3. Игрок размещает карты на поле, которые превращаются в юнитов, здания или эффекты (заклинания).
4. Войска двигаются автоматически к башням противника.
5. Бой идет в реальном времени, без пауз.
6. Скорость накапливания эликсира ускоряется, ближе к концу игры.
7. У всех карт уникальные механики взаимодействия друг с другом, с ареной и элексиром.


## Цель проекта
Создать программу с использованием компьютерного зрения (YOLO11) для анализа игры Clash Roale, и вывода полезной информации на экран (цикл карт, актуальное количество эликсира у противника).
Используем ОС Windows 11 only. В дальнейшем миграция на Android систему.


## Общий план
I. Обучение модели (бета-версия, модель на 20 классов)
II. Написание кода (проверка потенциала проекта, простая реализация)
III. Масштабирование (обучение модели на все 200 классов, улучшение кода)
IV. Миграция (на Kotlin в Android)
V. Распространение (YouTube, Boosty, Patrion)


### I. Обучение модели
1. создать пару записей боёв
2. определить список карт для бета версии (20 карт)
3. создать ~200 скриншотов, по 10+ скринов/карта
4. сделать разметку в Roboflow
5. проеврить полученную модель по метрикам
6. проверить модель по записанным видео (на глазок)

✓ все удачно, модель получилось обучить, результаты очень хорошие


### II. Написание кода
1. захват заданной области
2. передача картинок (1-4 кадра/сек)
3. обработка моделью
4. алгоритм анализа (определить цикл, эликсир)
5. вывод информации в терминал
6. вывод информации визуально
7. проверка скорость и точности


### III. Масштабирование
1. увеличение обучающей выборки в 10 раз, берем все 200 классов
2. обучаем модель среднего размера (YOLOv11-m), применяем structured pruning (30–50%), дообучаем, квантование INT8.
3. все вычислительные процессы на облачных ресурсах
4. оптемизация кода
5. дополнитеотная визуализация карт, эликсира (на экране сбоку)


### IV. Миграция


### V. Распространение


---

## Работа программы

### Требования
- Python 3.8 или выше
- Windows 10/11 (для захвата экрана)
- Обученная модель YOLO11 в папке `models/`


### Запуск программы

```bash
python app.py
```

### Первый запуск
При первом запуске программа попросит выбрать область экрана:
1. Откроется окно со скриншотом всего экрана
2. Выделите область с игрой Clash Royale мышью
3. Нажмите **Enter** для подтверждения или **ESC** для отмены
4. Координаты сохранятся в файл `roi_config.txt` (100,1100,1000,1700)

При следующих запусках программа автоматически загрузит сохраненные координаты.

### Управление
- **Ctrl+C** - принудительное завершение


---

## Структура проекта

```
project_13_ClashBot/
├── app.py                 # Главный файл запуска
├── config.py              # Конфигурация и настройки
├── requirements.txt       # Зависимости Python
├── roi_config.txt         # Сохраненные координаты области (создается автоматически)
├── modules/               # Модули программы
│   ├── __init__.py
│   ├── screen_capture.py  # Захват экрана
|   ├── overlay_dynamic.py # Для динамических overlay элементов
|   ├── overlay_static.py  # Для статичных overlay элементов
│   └── detector.py        # YOLO детекция
├── models/                # Обученные модели YOLO
│   └── train_clash_royale_test5/
│       └── weights/
│           └── best.pt    # Веса модели
└── README.md              # Документация
```
